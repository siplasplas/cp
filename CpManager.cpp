#include <cstdint>
#include "CpManager.h"
#include "UtfCodepage.h"
#include "TableCodepage.h"

using namespace std;

uint16_t cp1250[128] = {
        8364,129,8218,131,8222,8230,8224,8225,136,8240,352,8249,346,356,381,377,
        144,8216,8217,8220,8221,8226,8211,8212,152,8482,353,8250,347,357,382,378,
        160,711,728,321,164,260,166,167,168,169,350,171,172,173,174,379,
        176,177,731,322,180,181,182,183,184,261,351,187,317,733,318,380,
        340,193,194,258,196,313,262,199,268,201,280,203,282,205,206,270,
        272,323,327,211,212,336,214,215,344,366,218,368,220,221,354,223,
        341,225,226,259,228,314,263,231,269,233,281,235,283,237,238,271,
        273,324,328,243,244,337,246,247,345,367,250,369,252,253,355,729};

uint16_t cp1257[128] = {
        8364,129,8218,131,8222,8230,8224,8225,136,8240,138,8249,140,168,711,184,
        144,8216,8217,8220,8221,8226,8211,8212,152,8482,154,8250,156,175,731,159,
        160,63740,162,163,164,63741,166,167,216,169,342,171,172,173,174,198,
        176,177,178,179,180,181,182,183,248,185,343,187,188,189,190,230,
        260,302,256,262,196,197,280,274,268,201,377,278,290,310,298,315,
        352,323,325,211,332,213,214,215,370,321,346,362,220,379,381,223,
        261,303,257,263,228,229,281,275,269,233,378,279,291,311,299,316,
        353,324,326,243,333,245,246,247,371,322,347,363,252,380,382,729};
pair<uint16_t,uint16_t> bcp1257[94] = {
        {65281,33},{65282,34},{65283,35},{65284,36},{65285,37},{65286,38},{65287,39},{65288,40},{65289,41},{65290,42},{65291,43},{65292,44},{65293,45},{65294,46},{65295,47},{65296,48},
        {65297,49},{65298,50},{65299,51},{65300,52},{65301,53},{65302,54},{65303,55},{65304,56},{65305,57},{65306,58},{65307,59},{65308,60},{65309,61},{65310,62},{65311,63},{65312,64},
        {65313,65},{65314,66},{65315,67},{65316,68},{65317,69},{65318,70},{65319,71},{65320,72},{65321,73},{65322,74},{65323,75},{65324,76},{65325,77},{65326,78},{65327,79},{65328,80},
        {65329,81},{65330,82},{65331,83},{65332,84},{65333,85},{65334,86},{65335,87},{65336,88},{65337,89},{65338,90},{65339,91},{65340,92},{65341,93},{65342,94},{65343,95},{65344,96},
        {65345,97},{65346,98},{65347,99},{65348,100},{65349,101},{65350,102},{65351,103},{65352,104},{65353,105},{65354,106},{65355,107},{65356,108},{65357,109},{65358,110},{65359,111},{65360,112},
        {65361,113},{65362,114},{65363,115},{65364,116},{65365,117},{65366,118},{65367,119},{65368,120},{65369,121},{65370,122},{65371,123},{65372,124},{65373,125},{65374,126}};


CpManager::~CpManager() {
    for (auto cp: codepages)
        delete cp;
}

CpManager::CpManager() {
    codepages.emplace_back(new UtfCodepage("utf8",1,false));
    codepages.emplace_back(new UtfCodepage("utf16",2,false));
    codepages.emplace_back(new UtfCodepage("utf16be",2, true));
    codepages.emplace_back(new UtfCodepage("utf32",4,false));
    codepages.emplace_back(new UtfCodepage("utf32be",4, true));
    codepages.emplace_back(new TableCodepage("cp1250",cp1250));
    codepages.emplace_back(new TableCodepage("cp1257",cp1257, bcp1257));
}
